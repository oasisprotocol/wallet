const fs = require('fs')

const fileHeader = `
/* eslint-disable no-restricted-imports */
// Auto-generated by "yarn fix-grommet-icons-types"
// This is needed because grommet-icons does not define types for each individual icon file
`.trim()

const generatedFileName = 'src/types/fix-grommet-icons-types.d.ts'

const iconNames = fs
  .readFileSync('node_modules/grommet-icons/es6/icons/index.d.ts', 'utf8')
  .split('\n')
  .map(line => line.match(/^export declare const (\w+): Icon;$/)?.[1])
  .filter(iconName => iconName)

const moduleDeclarations = iconNames.map(
  iconName => `
declare module 'grommet-icons/es6/icons/${iconName}' {
  import { Icon } from 'grommet-icons/es6/icons'
  export declare const ${iconName}: Icon
}`,
)

fs.writeFileSync(generatedFileName, [fileHeader, ...moduleDeclarations, ''].join('\n'), 'utf8')
